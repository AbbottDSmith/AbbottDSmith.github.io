<!DOCTYPE html>
<html>
	<head>
  
		<title>API2 Checker</title>

		<h1 id="Header" style="text-align:center;">Vivokey API2 Status:</h1>
	
	</head>
	<body>
	
		<p id="Indicator" style="text-align:center;">Posting...</p>
		
		<r>
		
		<p id="HTTPStatus" style="visibility:hidden; text-align:center;"></p>
		
		<r>
		
		<p id="HTTPResponse" style="visibility:hidden; text-align:center;"></p>
		
		<r>
		
		<button id="Retry" onClick="buttonPress();" style="visibility:hidden; margin:auto; display:block;">Try Again</button>
		
	</body>
	<script>
		
		function getChallenge() {
		
			let xhr = new XMLHttpRequest();
			xhr.open("POST", "https://api2.vivokey.com/v1/get-challenge");
			xhr.setRequestHeader("Accept", "application/json");
			xhr.setRequestHeader("Content-Type", "application/json");
			
			let data = `{"api-key": "da7874db982d5506257be2ecf17c0e49bbdc64c121f40c02e5bc2019e99d"}`; <!-- https://youtu.be/pOF4DrQKKTw?t=199 -->
	  
			xhr.onreadystatechange = function () {
				if (xhr.readyState === 4) {
				
					document.getElementById("Header").innerHTML = "Vivokey API2 Status: <span style=\"color:" + (xhr.status == 200 ? "green;\">Online" : "red;\">Offline") + "</span>";
					document.getElementById("Indicator").innerHTML = "POST to get-challenge endpoint: <span style=\"color:" + (xhr.status == 200 ? "green;\">Success" : "red;\">Failed") + "</span>";
				
					document.getElementById("HTTPStatus").innerHTML = "HTTP Status Code: " + xhr.status;
					document.getElementById("HTTPResponse").innerHTML = "HTTP Response: " + (xhr.responseText == "" ? "Empty" : xhr.responseText);
					
					document.getElementById("HTTPStatus").style.visibility = "visible";
					document.getElementById("HTTPResponse").style.visibility = "visible";
					document.getElementById("Retry").style.visibility = "visible";
					
					return xhr.responseText;
				}
			};

			xhr.send(data);
		}
		
		function reset() {
			document.getElementById("Indicator").innerHTML = "Posting...";
			document.getElementById("HTTPStatus").style.visibility = "hidden";
			document.getElementById("HTTPResponse").style.visibility = "hidden";
			document.getElementById("Retry").style.visibility = "hidden";
		}
		
		function buttonPress() {
			reset();
			getChallenge();
		}
		
		getChallenge();
		
	</script>
</html>